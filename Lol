-- Modern UI Library v2
-- Adds: show/hide toggle button, runtime theme, transparency and size customization
-- Usage: local UI = require(path.to.modern_ui_library2).new("Title")
-- Then use UI:Tab(...) etc. New methods added:
-- UI:SetTheme(tbl) -- {Main, Accent, Panel, Text, SubText, Highlight}
-- UI:SetTransparency(n) -- 0..1 applied to main panels (0 = opaque, 1 = invisible)
-- UI:SetSize(width, height)
-- UI:SetTabWidth(width)
-- UI:SetToggleImage(imageId)
-- UI:SetWindowImage(imageId)

local TweenService = game:GetService("TweenService")
local UserInputService = game:GetService("UserInputService")
local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer

local UILibrary = {}
UILibrary.__index = UILibrary

-- Default theme
local DEFAULT_THEME = {
	Main = Color3.fromRGB(30, 30, 30),
	Accent = Color3.fromRGB(35, 35, 35),
	Panel = Color3.fromRGB(45, 45, 45),
	Text = Color3.fromRGB(230, 230, 230),
	SubText = Color3.fromRGB(200, 200, 200),
	Highlight = Color3.fromRGB(0, 162, 255),
	ShadowImage = "rbxassetid://6015897843",
	ToggleIcon = "rbxassetid://83280891382176",
	WindowIcon = "rbxassetid://83280891382176"
}

function UILibrary.new(title, opts)
	local library = {}
	setmetatable(library, UILibrary)

	opts = opts or {}
	-- store state for customization
	library.Theme = opts.Theme or DEFAULT_THEME
	library.Transparency = (opts.Transparency ~= nil) and opts.Transparency or 0.55
	library.Width = (opts.Width and tonumber(opts.Width)) or 500
	library.Height = (opts.Height and tonumber(opts.Height)) or 350
	library.TabWidth = (opts.TabWidth and tonumber(opts.TabWidth)) or 120
	library.ToggleIcon = opts.ToggleIcon or library.Theme.ToggleIcon
	library.WindowIcon = opts.WindowIcon or library.Theme.WindowIcon

	-- Create ScreenGui
	local ScreenGui = Instance.new("ScreenGui")
	ScreenGui.Name = "ModernUI"
	ScreenGui.Parent = LocalPlayer:WaitForChild("PlayerGui")
	ScreenGui.ZIndexBehavior = Enum.ZIndexBehavior.Sibling

	-- Show/Hide toggle icon (draggable)
	local IconContainer = Instance.new("Frame")
	IconContainer.Name = "IconContainer"
	IconContainer.Size = UDim2.new(0, 56, 0, 56)
	IconContainer.Position = UDim2.new(0, 20, 0, 20)
	IconContainer.BackgroundTransparency = 1
	IconContainer.Active = true
	IconContainer.Draggable = true
	IconContainer.Parent = ScreenGui

	local IconBtn = Instance.new("ImageButton")
	IconBtn.Name = "ToggleIcon"
	IconBtn.Size = UDim2.new(1, 0, 1, 0)
	IconBtn.BackgroundColor3 = library.Theme.Main
	IconBtn.BorderSizePixel = 0
	IconBtn.AutoButtonColor = false
	IconBtn.Image = library.ToggleIcon
	IconBtn.ImageColor3 = library.Theme.Highlight
	IconBtn.ScaleType = Enum.ScaleType.Fit
	IconBtn.Parent = IconContainer

	local IconCorner = Instance.new("UICorner", IconBtn)
	IconCorner.CornerRadius = UDim.new(0, 12)

	-- MainFrame
	local MainFrame = Instance.new("Frame")
	MainFrame.Name = "MainFrame"
	MainFrame.Size = UDim2.new(0, library.Width, 0, library.Height)
	MainFrame.Position = UDim2.new(0.5, -(library.Width/2), 0.5, -(library.Height/2))
	MainFrame.BackgroundColor3 = library.Theme.Main
	MainFrame.BackgroundTransparency = library.Transparency
	MainFrame.BorderSizePixel = 0
	MainFrame.Parent = ScreenGui

	local UICorner = Instance.new("UICorner", MainFrame)
	UICorner.CornerRadius = UDim.new(0, 9)

	-- Shadow
	local Shadow = Instance.new("ImageLabel")
	Shadow.Name = "Shadow"
	Shadow.BackgroundTransparency = 1
	Shadow.Position = UDim2.new(0, -15, 0, -15)
	Shadow.Size = UDim2.new(1, 30, 1, 30)
	Shadow.ZIndex = -1
	Shadow.Image = library.Theme.ShadowImage
	Shadow.ImageColor3 = Color3.fromRGB(0, 0, 0)
	Shadow.ScaleType = Enum.ScaleType.Slice
	Shadow.SliceCenter = Rect.new(23, 23, 277, 277)
	Shadow.Parent = MainFrame

	-- TitleBar
	local TitleBar = Instance.new("Frame")
	TitleBar.Name = "TitleBar"
	TitleBar.Size = UDim2.new(1, 0, 0, 34)
	TitleBar.BackgroundColor3 = library.Theme.Accent
	TitleBar.BackgroundTransparency = library.Transparency
	TitleBar.BorderSizePixel = 0
	TitleBar.Parent = MainFrame

	local UICornerTitle = Instance.new("UICorner", TitleBar)
	UICornerTitle.CornerRadius = UDim.new(0, 8)

	-- Window icon (left)
	local WindowIcon = Instance.new("ImageLabel")
	WindowIcon.Name = "WindowIcon"
	WindowIcon.Size = UDim2.new(0, 28, 0, 28)
	WindowIcon.Position = UDim2.new(0, 8, 0.5, -14)
	WindowIcon.BackgroundTransparency = 1
	WindowIcon.Image = library.WindowIcon
	WindowIcon.ImageColor3 = library.Theme.Highlight
	WindowIcon.Parent = TitleBar

	-- Title text
	local TitleText = Instance.new("TextLabel")
	TitleText.Name = "Title"
	TitleText.Size = UDim2.new(1, -120, 1, 0)
	TitleText.Position = UDim2.new(0, 44, 0, 0)
	TitleText.BackgroundTransparency = 1
	TitleText.TextColor3 = library.Theme.Text
	TitleText.TextSize = 16
	TitleText.Font = Enum.Font.GothamSemibold
	TitleText.TextXAlignment = Enum.TextXAlignment.Left
	TitleText.Text = title or "Modern UI Library"
	TitleText.Parent = TitleBar

	-- Close button (right)
	local CloseButton = Instance.new("TextButton")
	CloseButton.Name = "CloseButton"
	CloseButton.Size = UDim2.new(0, 28, 0, 28)
	CloseButton.Position = UDim2.new(1, -36, 0.5, -14)
	CloseButton.BackgroundTransparency = 1
	CloseButton.TextColor3 = library.Theme.Text
	CloseButton.TextSize = 18
	CloseButton.Font = Enum.Font.GothamBold
	CloseButton.Text = "Ã—"
	CloseButton.Parent = TitleBar

	-- TabContainer
	local TabContainer = Instance.new("Frame")
	TabContainer.Name = "TabContainer"
	TabContainer.Size = UDim2.new(0, library.TabWidth, 1, -34)
	TabContainer.Position = UDim2.new(0, 0, 0, 34)
	TabContainer.BackgroundColor3 = library.Theme.Accent
	TabContainer.BackgroundTransparency = library.Transparency
	TabContainer.BorderSizePixel = 0
	TabContainer.Parent = MainFrame

	local UICornerTabContainer = Instance.new("UICorner", TabContainer)
	UICornerTabContainer.CornerRadius = UDim.new(0, 8)

	local TabButtonHolder = Instance.new("ScrollingFrame")
	TabButtonHolder.Name = "TabButtonHolder"
	TabButtonHolder.Size = UDim2.new(1, 0, 1, 0)
	TabButtonHolder.CanvasSize = UDim2.new(0, 0, 0, 0)
	TabButtonHolder.BackgroundTransparency = 1
	TabButtonHolder.ScrollBarThickness = 2
	TabButtonHolder.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 100)
	TabButtonHolder.BorderSizePixel = 0
	TabButtonHolder.Parent = TabContainer

	local TabButtonList = Instance.new("UIListLayout")
	TabButtonList.SortOrder = Enum.SortOrder.LayoutOrder
	TabButtonList.Padding = UDim.new(0, 6)
	TabButtonList.Parent = TabButtonHolder

	local TabButtonPadding = Instance.new("UIPadding")
	TabButtonPadding.PaddingTop = UDim.new(0, 10)
	TabButtonPadding.PaddingLeft = UDim.new(0, 10)
	TabButtonPadding.PaddingRight = UDim.new(0, 10)
	TabButtonPadding.PaddingBottom = UDim.new(0, 10)
	TabButtonPadding.Parent = TabButtonHolder

	-- ContentContainer
	local ContentContainer = Instance.new("Frame")
	ContentContainer.Name = "ContentContainer"
	ContentContainer.Size = UDim2.new(1, -(library.TabWidth + 30), 1, -54)
	ContentContainer.Position = UDim2.new(0, library.TabWidth + 20, 0, 40)
	ContentContainer.BackgroundColor3 = library.Theme.Main
	ContentContainer.BackgroundTransparency = library.Transparency
	ContentContainer.BorderSizePixel = 0
	ContentContainer.ClipsDescendants = true
	ContentContainer.Parent = MainFrame

	-- small visual divider (right edge of tabs)
	local Divider = Instance.new("Frame")
	Divider.Name = "Divider"
	Divider.Size = UDim2.new(0, 4, 1, -34)
	Divider.Position = UDim2.new(0, library.TabWidth - 4, 0, 34)
	Divider.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
	Divider.BackgroundTransparency = library.Transparency
	Divider.BorderSizePixel = 0
	Divider.Parent = MainFrame

	-- store library refs
	library.ScreenGui = ScreenGui
	library.MainFrame = MainFrame
	library.TitleBar = TitleBar
	library.TitleText = TitleText
	library.TabContainer = TabContainer
	library.TabButtonHolder = TabButtonHolder
	library.ContentContainer = ContentContainer
	library.Tabs = {}
	library.ActiveTab = nil
	library.IconContainer = IconContainer
	library.IconBtn = IconBtn
	library.WindowIcon = WindowIcon

	-- Close behavior
	CloseButton.MouseButton1Click:Connect(function()
		ScreenGui:Destroy()
		if library.IconContainer and library.IconContainer.Parent then
			library.IconContainer:Destroy()
		end
	end)

	-- Dragging for window via TitleBar
	local dragging, dragInput, dragStart, startPos
	local function update(input)
		local delta = input.Position - dragStart
		MainFrame.Position = UDim2.new(startPos.X.Scale, startPos.X.Offset + delta.X, startPos.Y.Scale, startPos.Y.Offset + delta.Y)
	end

	local function beginDrag(input)
		dragging = true
		dragStart = input.Position
		startPos = MainFrame.Position
		local conn
		conn = input.Changed:Connect(function()
			if input.UserInputState == Enum.UserInputState.End then
				dragging = false
				conn:Disconnect()
			end
		end)
	end

	TitleBar.InputBegan:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
			beginDrag(input)
		end
	end)

	TitleBar.InputChanged:Connect(function(input)
		if input.UserInputType == Enum.UserInputType.MouseMovement then
			dragInput = input
		end
	end)

	UserInputService.InputChanged:Connect(function(input)
		if input == dragInput and dragging then
			update(input)
		end
	end)

	-- Icon toggle behavior (show/hide main window)
	IconBtn.MouseButton1Click:Connect(function()
		if MainFrame.Visible then
			-- hide
			TweenService:Create(MainFrame, TweenInfo.new(0.28, Enum.EasingStyle.Quint, Enum.EasingDirection.Out), {Size = UDim2.new(0, 0, 0, 0), Position = UDim2.new(0.5, 0, 0.5, 0)}):Play()
			task.wait(0.28)
			MainFrame.Visible = false
			MainFrame.Size = UDim2.new(0, library.Width, 0, library.Height)
			MainFrame.Position = UDim2.new(0.5, -(library.Width/2), 0.5, -(library.Height/2))
		else
			-- show
			MainFrame.Size = UDim2.new(0, 0, 0, 0)
			MainFrame.Position = UDim2.new(0.5, 0, 0.5, 0)
			MainFrame.Visible = true
			TweenService:Create(MainFrame, TweenInfo.new(0.35, Enum.EasingStyle.Back, Enum.EasingDirection.Out), {Size = UDim2.new(0, library.Width, 0, library.Height), Position = UDim2.new(0.5, -(library.Width/2), 0.5, -(library.Height/2))}):Play()
		end
	end)

	-- API methods to adjust look/size at runtime
	function library:SetTheme(tbl)
		-- expected fields: Main, Accent, Panel, Text, SubText, Highlight, ShadowImage, ToggleIcon, WindowIcon
		for k, v in pairs(tbl) do
			self.Theme[k] = v
		end

		-- apply to core elements
		pcall(function()
			self.MainFrame.BackgroundColor3 = self.Theme.Main
			self.MainFrame.BackgroundTransparency = self.Transparency
			self.TitleBar.BackgroundColor3 = self.Theme.Accent
			self.TitleBar.BackgroundTransparency = self.Transparency
			self.TabContainer.BackgroundColor3 = self.Theme.Accent
			self.TabContainer.BackgroundTransparency = self.Transparency
			self.ContentContainer.BackgroundColor3 = self.Theme.Main
			self.ContentContainer.BackgroundTransparency = self.Transparency
			self.TitleText.TextColor3 = self.Theme.Text
			if self.WindowIcon and self.Theme.WindowIcon then
				self.WindowIcon.Image = self.Theme.WindowIcon
			end
			if self.IconBtn and self.Theme.ToggleIcon then
				self.IconBtn.Image = self.Theme.ToggleIcon
			end
			-- update existing tabs/buttons/content colors
			for _, child in ipairs(self.TabButtonHolder:GetChildren()) do
				if child:IsA("TextButton") then
					pcall(function() child.BackgroundColor3 = self.Theme.Panel; child.TextColor3 = self.Theme.Text end)
					for _, c2 in ipairs(child:GetChildren()) do
						if c2:IsA("TextLabel") then
							c2.TextColor3 = self.Theme.SubText
						elseif c2:IsA("ImageLabel") then
							pcall(function() c2.ImageColor3 = self.Theme.Highlight end)
						end
					end
				end
			end
			for _, content in ipairs(self.ContentContainer:GetChildren()) do
				-- update common element backgrounds for previously created elements
				for _, elem in ipairs(content:GetDescendants()) do
					if elem:IsA("Frame") and elem.Name:match("Button") then
						pcall(function() elem.BackgroundColor3 = self.Theme.Panel; elem.BackgroundTransparency = 0 end)
					end
					if elem:IsA("TextLabel") then
						pcall(function() elem.TextColor3 = self.Theme.Text end)
					end
				end
			end
		end)
	end

	function library:SetTransparency(n)
		self.Transparency = math.clamp(tonumber(n) or 0, 0, 1)
		pcall(function()
			self.MainFrame.BackgroundTransparency = self.Transparency
			self.TitleBar.BackgroundTransparency = self.Transparency
			self.TabContainer.BackgroundTransparency = self.Transparency
			self.ContentContainer.BackgroundTransparency = self.Transparency
			self.Divider = self.Divider -- noop in case needed
			-- update many child frames that are panels to match the look
			for _, descendant in ipairs(self.MainFrame:GetDescendants()) do
				if descendant:IsA("Frame") and descendant ~= self.MainFrame and descendant ~= self.TitleBar and descendant ~= self.TabContainer and descendant ~= self.ContentContainer then
					-- only adjust those created as semi-opaque panels (best-effort)
					if descendant.BackgroundColor3 and descendant.Name:match("Container") or descendant.Name:match("Frame") or descendant.Name:match("Button") then
						pcall(function() descendant.BackgroundTransparency = (descendant.BackgroundTransparency == 1) and 1 or self.Transparency end)
					end
				end
			end
		end)
	end

	function library:SetSize(width, height)
		width = tonumber(width) or library.Width
		height = tonumber(height) or library.Height
		library.Width = width
		library.Height = height
		-- apply
		self.MainFrame.Size = UDim2.new(0, width, 0, height)
		self.MainFrame.Position = UDim2.new(0.5, -(width/2), 0.5, -(height/2))
		-- adjust content container height if needed
		self.ContentContainer.Size = UDim2.new(1, -(self.TabWidth + 30), 1, -54)
	end

	function library:SetTabWidth(width)
		width = tonumber(width) or library.TabWidth
		library.TabWidth = width
		self.TabContainer.Size = UDim2.new(0, width, 1, -34)
		self.ContentContainer.Size = UDim2.new(1, -(width + 30), 1, -54)
		self.ContentContainer.Position = UDim2.new(0, width + 20, 0, 40)
		-- update divider
		if self.MainFrame:FindFirstChild("Divider") then
			self.MainFrame.Divider.Position = UDim2.new(0, width - 4, 0, 34)
			self.MainFrame.Divider.Size = UDim2.new(0, 4, 1, -34)
		end
	end

	function library:SetToggleImage(imageId)
		if imageId then
			library.ToggleIcon = imageId
			pcall(function() library.IconBtn.Image = imageId end)
		end
	end

	function library:SetWindowImage(imageId)
		if imageId then
			library.WindowIcon = imageId
			pcall(function() library.WindowIcon.Image = imageId end)
		end
	end

	-- Tab creation (same interface as before)
	function UILibrary.Tab(self, name, icon)
		local tab = {}

		local tabButton = Instance.new("TextButton")
		tabButton.Name = name.."Tab"
		tabButton.Size = UDim2.new(1, 0, 0, 36)
		tabButton.BackgroundColor3 = library.Theme.Panel
		tabButton.BackgroundTransparency = 0
		tabButton.BorderSizePixel = 0
		tabButton.Text = ""
		tabButton.AutoButtonColor = false
		tabButton.Parent = library.TabButtonHolder

		local UICornerTabButton = Instance.new("UICorner")
		UICornerTabButton.CornerRadius = UDim.new(0, 6)
		UICornerTabButton.Parent = tabButton

		local TabIcon
		if icon then
			TabIcon = Instance.new("ImageLabel")
			TabIcon.Name = "Icon"
			TabIcon.Size = UDim2.new(0, 20, 0, 20)
			TabIcon.Position = UDim2.new(0, 8, 0.5, -10)
			TabIcon.BackgroundTransparency = 1
			TabIcon.Image = icon
			TabIcon.ImageColor3 = library.Theme.Highlight
			TabIcon.Parent = tabButton
		end

		local TabText = Instance.new("TextLabel")
		TabText.Name = "TabText"
		TabText.Size = UDim2.new(1, icon and -36 or -16, 1, 0)
		TabText.Position = UDim2.new(0, icon and 36 or 8, 0, 0)
		TabText.BackgroundTransparency = 1
		TabText.TextColor3 = library.Theme.SubText
		TabText.TextSize = 14
		TabText.Font = Enum.Font.GothamMedium
		TabText.TextXAlignment = Enum.TextXAlignment.Left
		TabText.Text = name
		TabText.Parent = tabButton

		local TabIndicator = Instance.new("Frame")
		TabIndicator.Name = "Indicator"
		TabIndicator.Size = UDim2.new(0, 3, 0.7, 0)
		TabIndicator.Position = UDim2.new(0, 0, 0.15, 0)
		TabIndicator.BackgroundColor3 = library.Theme.Highlight
		TabIndicator.BorderSizePixel = 0
		TabIndicator.BackgroundTransparency = 1
		TabIndicator.Parent = tabButton

		local TabContent = Instance.new("ScrollingFrame")
		TabContent.Name = name.."Content"
		TabContent.Size = UDim2.new(1, 0, 1, 0)
		TabContent.BackgroundTransparency = 1
		TabContent.BorderSizePixel = 0
		TabContent.ScrollBarThickness = 3
		TabContent.ScrollBarImageColor3 = Color3.fromRGB(100, 100, 100)
		TabContent.Visible = false
		TabContent.Parent = library.ContentContainer
		TabContent.CanvasSize = UDim2.new(0, 0, 0, 0)
		TabContent.AutomaticCanvasSize = Enum.AutomaticSize.Y

		local ContentList = Instance.new("UIListLayout")
		ContentList.SortOrder = Enum.SortOrder.LayoutOrder
		ContentList.Padding = UDim.new(0, 6)
		ContentList.Parent = TabContent

		local ContentPadding = Instance.new("UIPadding")
		ContentPadding.PaddingTop = UDim.new(0, 8)
		ContentPadding.PaddingLeft = UDim.new(0, 10)
		ContentPadding.PaddingRight = UDim.new(0, 10)
		ContentPadding.PaddingBottom = UDim.new(0, 10)
		ContentPadding.Parent = TabContent

		tabButton.MouseButton1Click:Connect(function()
			self:SelectTab(name)
		end)

		tab.Button = tabButton
		tab.Content = TabContent
		tab.Indicator = TabIndicator

		table.insert(library.Tabs, tab)

		-- update holder canvas size (best-effort)
		library.TabButtonHolder.CanvasSize = UDim2.new(0, 0, 0, ContentList.AbsoluteContentSize.Y + 20)

		if #library.Tabs == 1 then
			library:SelectTab(name)
		end

		-- section functions (subset implemented - Button, TextBox, Dropdown, Toggle, Slider, Notification)
		local sectionFunctions = {}

		function sectionFunctions:Button(text, callback)
			callback = callback or function() end

			local ButtonFrame = Instance.new("Frame")
			ButtonFrame.Name = text.."ButtonFrame"
			ButtonFrame.Size = UDim2.new(1, 0, 0, 36)
			ButtonFrame.BackgroundTransparency = 1
			ButtonFrame.Parent = TabContent

			local Button = Instance.new("TextButton")
			Button.Name = text.."Button"
			Button.Size = UDim2.new(1, 0, 1, 0)
			Button.BackgroundColor3 = library.Theme.Panel
			Button.BackgroundTransparency = 0
			Button.BorderSizePixel = 0
			Button.Text = ""
			Button.AutoButtonColor = false
			Button.Parent = ButtonFrame

			local UICornerButton = Instance.new("UICorner")
			UICornerButton.CornerRadius = UDim.new(0, 6)
			UICornerButton.Parent = Button

			local ButtonText = Instance.new("TextLabel")
			ButtonText.Name = "ButtonText"
			ButtonText.Size = UDim2.new(1, -16, 1, 0)
			ButtonText.Position = UDim2.new(0, 8, 0, 0)
			ButtonText.BackgroundTransparency = 1
			ButtonText.TextColor3 = library.Theme.Text
			ButtonText.TextSize = 14
			ButtonText.Font = Enum.Font.GothamMedium
			ButtonText.TextXAlignment = Enum.TextXAlignment.Left
			ButtonText.Text = text
			ButtonText.Parent = Button

			Button.MouseEnter:Connect(function()
				TweenService:Create(Button, TweenInfo.new(0.18), {BackgroundColor3 = library.Theme.Panel:Lerp(Color3.fromRGB(60,60,60), 0.15)}):Play()
			end)

			Button.MouseLeave:Connect(function()
				TweenService:Create(Button, TweenInfo.new(0.18), {BackgroundColor3 = library.Theme.Panel}):Play()
			end)

			Button.MouseButton1Click:Connect(function()
				pcall(callback)
			end)

			return ButtonFrame
		end

		function sectionFunctions:TextBox(text, placeholder, callback)
			placeholder = placeholder or ""
			callback = callback or function() end

			local TextBoxFrame = Instance.new("Frame")
			TextBoxFrame.Name = text.."TextBoxFrame"
			TextBoxFrame.Size = UDim2.new(1, 0, 0, 56)
			TextBoxFrame.BackgroundTransparency = 1
			TextBoxFrame.Parent = TabContent

			local TextBoxContainer = Instance.new("Frame")
			TextBoxContainer.Name = text.."TextBoxContainer"
			TextBoxContainer.Size = UDim2.new(1, 0, 1, 0)
			TextBoxContainer.BackgroundColor3 = library.Theme.Panel
			TextBoxContainer.BackgroundTransparency = 0
			TextBoxContainer.BorderSizePixel = 0
			TextBoxContainer.Parent = TextBoxFrame

			local UICornerTextBox = Instance.new("UICorner")
			UICornerTextBox.CornerRadius = UDim.new(0, 6)
			UICornerTextBox.Parent = TextBoxContainer

			local TextBoxTitle = Instance.new("TextLabel")
			TextBoxTitle.Name = "TextBoxTitle"
			TextBoxTitle.Size = UDim2.new(1, -8, 0, 20)
			TextBoxTitle.Position = UDim2.new(0, 8, 0, 6)
			TextBoxTitle.BackgroundTransparency = 1
			TextBoxTitle.TextColor3 = library.Theme.Text
			TextBoxTitle.TextSize = 14
			TextBoxTitle.Font = Enum.Font.GothamMedium
			TextBoxTitle.TextXAlignment = Enum.TextXAlignment.Left
			TextBoxTitle.Text = text
			TextBoxTitle.Parent = TextBoxContainer

			local TextBoxBg = Instance.new("Frame")
			TextBoxBg.Name = "TextBoxBg"
			TextBoxBg.Size = UDim2.new(1, -16, 0, 24)
			TextBoxBg.Position = UDim2.new(0, 8, 0, 28)
			TextBoxBg.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
			TextBoxBg.BorderSizePixel = 0
			TextBoxBg.Parent = TextBoxContainer

			local UICornerTextBoxBg = Instance.new("UICorner")
			UICornerTextBoxBg.CornerRadius = UDim.new(0, 4)
			UICornerTextBoxBg.Parent = TextBoxBg

			local TextBoxInput = Instance.new("TextBox")
			TextBoxInput.Name = "TextBoxInput"
			TextBoxInput.Size = UDim2.new(1, -8, 1, 0)
			TextBoxInput.Position = UDim2.new(0, 8, 0, 0)
			TextBoxInput.BackgroundTransparency = 1
			TextBoxInput.TextColor3 = library.Theme.Text
			TextBoxInput.PlaceholderColor3 = library.Theme.SubText
			TextBoxInput.TextSize = 14
			TextBoxInput.Font = Enum.Font.Gotham
			TextBoxInput.TextXAlignment = Enum.TextXAlignment.Left
			TextBoxInput.PlaceholderText = placeholder
			TextBoxInput.Text = ""
			TextBoxInput.ClearTextOnFocus = false
			TextBoxInput.Parent = TextBoxBg

			TextBoxInput.FocusLost:Connect(function(enterPressed)
				if enterPressed then pcall(callback, TextBoxInput.Text) end
			end)

			return TextBoxFrame
		end

		function sectionFunctions:Dropdown(text, options, default, callback)
			options = options or {}
			callback = callback or function() end
			local open = false

			local DropdownFrame = Instance.new("Frame")
			DropdownFrame.Name = text.."DropdownFrame"
			DropdownFrame.Size = UDim2.new(1, 0, 0, 56)
			DropdownFrame.BackgroundTransparency = 1
			DropdownFrame.Parent = TabContent
			DropdownFrame.ClipsDescendants = true

			local Dropdown = Instance.new("Frame")
			Dropdown.Name = text.."Dropdown"
			Dropdown.Size = UDim2.new(1, 0, 0, 56)
			Dropdown.BackgroundColor3 = library.Theme.Panel
			Dropdown.BorderSizePixel = 0
			Dropdown.Parent = DropdownFrame

			local UICornerDropdown = Instance.new("UICorner")
			UICornerDropdown.CornerRadius = UDim.new(0, 6)
			UICornerDropdown.Parent = Dropdown

			local DropdownText = Instance.new("TextLabel")
			DropdownText.Name = "DropdownText"
			DropdownText.Size = UDim2.new(1, -8, 0, 20)
			DropdownText.Position = UDim2.new(0, 8, 0, 6)
			DropdownText.BackgroundTransparency = 1
			DropdownText.TextColor3 = library.Theme.Text
			DropdownText.TextSize = 14
			DropdownText.Font = Enum.Font.GothamMedium
			DropdownText.TextXAlignment = Enum.TextXAlignment.Left
			DropdownText.Text = text
			DropdownText.Parent = Dropdown

			local DropdownButton = Instance.new("TextButton")
			DropdownButton.Name = "DropdownButton"
			DropdownButton.Size = UDim2.new(1, -16, 0, 24)
			DropdownButton.Position = UDim2.new(0, 8, 0, 28)
			DropdownButton.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
			DropdownButton.BorderSizePixel = 0
			DropdownButton.Text = ""
			DropdownButton.AutoButtonColor = false
			DropdownButton.Parent = Dropdown

			local UICornerButton = Instance.new("UICorner")
			UICornerButton.CornerRadius = UDim.new(0, 4)
			UICornerButton.Parent = DropdownButton

			local SelectedText = Instance.new("TextLabel")
			SelectedText.Name = "SelectedText"
			SelectedText.Size = UDim2.new(1, -30, 1, 0)
			SelectedText.Position = UDim2.new(0, 8, 0, 0)
			SelectedText.BackgroundTransparency = 1
			SelectedText.TextColor3 = library.Theme.Text
			SelectedText.TextSize = 14
			SelectedText.Font = Enum.Font.Gotham
			SelectedText.TextXAlignment = Enum.TextXAlignment.Left
			SelectedText.Text = default or "Select..."
			SelectedText.Parent = DropdownButton
			SelectedText.ClipsDescendants = true
			SelectedText.TextTruncate = Enum.TextTruncate.AtEnd

			local ArrowIcon = Instance.new("ImageLabel")
			ArrowIcon.Name = "ArrowIcon"
			ArrowIcon.Size = UDim2.new(0, 16, 0, 16)
			ArrowIcon.Position = UDim2.new(1, -24, 0.5, -8)
			ArrowIcon.BackgroundTransparency = 1
			ArrowIcon.Image = "rbxassetid://7072706318"
			ArrowIcon.ImageColor3 = library.Theme.SubText
			ArrowIcon.Parent = DropdownButton

			local OptionContainer = Instance.new("Frame")
			OptionContainer.Name = "OptionContainer"
			OptionContainer.Size = UDim2.new(1, -16, 0, 0)
			OptionContainer.Position = UDim2.new(0, 8, 0, 56)
			OptionContainer.BackgroundColor3 = library.Theme.Panel
			OptionContainer.BorderSizePixel = 0
			OptionContainer.ClipsDescendants = true
			OptionContainer.Visible = false
			OptionContainer.Parent = Dropdown

			local UICornerOptionContainer = Instance.new("UICorner")
			UICornerOptionContainer.CornerRadius = UDim.new(0, 4)
			UICornerOptionContainer.Parent = OptionContainer

			local OptionList = Instance.new("ScrollingFrame")
			OptionList.Name = "OptionList"
			OptionList.Size = UDim2.new(1, 0, 1, 0)
			OptionList.BackgroundTransparency = 1
			OptionList.BorderSizePixel = 0
			OptionList.ScrollBarThickness = 2
			OptionList.ScrollBarImageColor3 = library.Theme.SubText
			OptionList.Visible = true
			OptionList.Parent = OptionContainer
			OptionList.CanvasSize = UDim2.new(0, 0, 0, 0)
			OptionList.AutomaticCanvasSize = Enum.AutomaticSize.Y

			local OptionListLayout = Instance.new("UIListLayout")
			OptionListLayout.SortOrder = Enum.SortOrder.LayoutOrder
			OptionListLayout.Padding = UDim.new(0, 4)
			OptionListLayout.Parent = OptionList

			local OptionListPadding = Instance.new("UIPadding")
			OptionListPadding.PaddingTop = UDim.new(0, 4)
			OptionListPadding.PaddingLeft = UDim.new(0, 4)
			OptionListPadding.PaddingRight = UDim.new(0, 4)
			OptionListPadding.PaddingBottom = UDim.new(0, 4)
			OptionListPadding.Parent = OptionList

			local function updateDropdown()
				if #options > 0 then
					local optionHeight = #options * 28 + (#options - 1) * 4 + 8
					optionHeight = math.min(optionHeight, 120)

					if open then
						OptionContainer.Visible = true
						OptionContainer.Size = UDim2.new(1, -16, 0, 0)

						local dropdownTween = TweenService:Create(
							DropdownFrame, 
							TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.Out), 
							{Size = UDim2.new(1, 0, 0, 56 + optionHeight)}
						)

						local containerTween = TweenService:Create(
							OptionContainer, 
							TweenInfo.new(0.4, Enum.EasingStyle.Back, Enum.EasingDirection.Out), 
							{Size = UDim2.new(1, -16, 0, optionHeight)}
						)

						local arrowTween = TweenService:Create(
							ArrowIcon, 
							TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), 
							{Rotation = 180}
						)

						dropdownTween:Play()
						containerTween:Play()
						arrowTween:Play()

						OptionList.CanvasPosition = Vector2.new(0, 0)
					else
						local dropdownTween = TweenService:Create(
							DropdownFrame, 
							TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), 
							{Size = UDim2.new(1, 0, 0, 56)}
						)

						local containerTween = TweenService:Create(
							OptionContainer, 
							TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), 
							{Size = UDim2.new(1, -16, 0, 0)}
						)

						local arrowTween = TweenService:Create(
							ArrowIcon, 
							TweenInfo.new(0.3, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), 
							{Rotation = 0}
						)

						dropdownTween:Play()
						containerTween:Play()
						arrowTween:Play()

						containerTween.Completed:Connect(function()
							if not open then
								OptionContainer.Visible = false
							end
						end)
					end
				end
			end

			local function addOptions()
				for _, option in pairs(OptionList:GetChildren()) do
					if option:IsA("TextButton") then
						option:Destroy()
					end
				end

				for i, option in ipairs(options) do
					local OptionButton = Instance.new("TextButton")
					OptionButton.Name = "Option_" .. tostring(i)
					OptionButton.Size = UDim2.new(1, 0, 0, 28)
					OptionButton.BackgroundColor3 = library.Theme.Panel
					OptionButton.BorderSizePixel = 0
					OptionButton.Text = ""
					OptionButton.AutoButtonColor = false
					OptionButton.Parent = OptionList

					local UICornerOption = Instance.new("UICorner")
					UICornerOption.CornerRadius = UDim.new(0, 4)
					UICornerOption.Parent = OptionButton

					local OptionLabel = Instance.new("TextLabel")
					OptionLabel.Name = "OptionLabel"
					OptionLabel.Size = UDim2.new(1, -8, 1, 0)
					OptionLabel.Position = UDim2.new(0, 8, 0, 0)
					OptionLabel.BackgroundTransparency = 1
					OptionLabel.TextColor3 = library.Theme.Text
					OptionLabel.TextSize = 14
					OptionLabel.Font = Enum.Font.Gotham
					OptionLabel.TextXAlignment = Enum.TextXAlignment.Left
					OptionLabel.Text = tostring(option)
					OptionLabel.ClipsDescendants = true
					OptionLabel.TextTruncate = Enum.TextTruncate.AtEnd
					OptionLabel.Parent = OptionButton

					OptionButton.MouseEnter:Connect(function()
						TweenService:Create(OptionButton, TweenInfo.new(0.14), {BackgroundColor3 = library.Theme.Panel:Lerp(Color3.fromRGB(60,60,60), 0.12)}):Play()
					end)
					OptionButton.MouseLeave:Connect(function()
						TweenService:Create(OptionButton, TweenInfo.new(0.14), {BackgroundColor3 = library.Theme.Panel}):Play()
					end)

					OptionButton.MouseButton1Click:Connect(function()
						SelectedText.Text = tostring(option)
						open = false
						updateDropdown()
						pcall(callback, option)
					end)
				end
			end

			DropdownButton.MouseButton1Click:Connect(function()
				open = not open
				updateDropdown()
			end)

			-- initial populate
			addOptions()

			local DropdownMethods = {}
			function DropdownMethods:SetOptions(newOptions)
				options = newOptions
				addOptions()
				if open then updateDropdown() end
			end
			function DropdownMethods:SetValue(value)
				SelectedText.Text = value
				pcall(callback, value)
			end

			return DropdownFrame, DropdownMethods
		end

		function sectionFunctions:ColorPicker(text, callback, defaultColor)
			-- re-use the ColorPicker from earlier file (kept simplified here)
			defaultColor = defaultColor or Color3.fromRGB(255, 0, 0)
			callback = callback or function() end
			-- Minimal implementation: a button that opens a small popup with color preview + confirm
			local ColorPickerFrame = Instance.new("Frame")
			ColorPickerFrame.Name = text.."ColorPickerFrame"
			ColorPickerFrame.Size = UDim2.new(1, 0, 0, 56)
			ColorPickerFrame.BackgroundTransparency = 1
			ColorPickerFrame.Parent = TabContent

			local ColorPicker = Instance.new("Frame")
			ColorPicker.Name = text.."ColorPicker"
			ColorPicker.Size = UDim2.new(1, 0, 0, 56)
			ColorPicker.BackgroundColor3 = library.Theme.Panel
			ColorPicker.BorderSizePixel = 0
			ColorPicker.Parent = ColorPickerFrame

			local UICornerColorPicker = Instance.new("UICorner")
			UICornerColorPicker.CornerRadius = UDim.new(0, 6)
			UICornerColorPicker.Parent = ColorPicker

			local ColorPickerText = Instance.new("TextLabel")
			ColorPickerText.Name = "ColorPickerText"
			ColorPickerText.Size = UDim2.new(1, -8, 0, 20)
			ColorPickerText.Position = UDim2.new(0, 8, 0, 6)
			ColorPickerText.BackgroundTransparency = 1
			ColorPickerText.TextColor3 = library.Theme.Text
			ColorPickerText.TextSize = 14
			ColorPickerText.Font = Enum.Font.GothamMedium
			ColorPickerText.TextXAlignment = Enum.TextXAlignment.Left
			ColorPickerText.Text = text
			ColorPickerText.Parent = ColorPicker

			local ColorDisplay = Instance.new("Frame")
			ColorDisplay.Name = "ColorDisplay"
			ColorDisplay.Size = UDim2.new(0, 28, 0, 28)
			ColorDisplay.Position = UDim2.new(1, -36, 0, 14)
			ColorDisplay.BackgroundColor3 = defaultColor
			ColorDisplay.BorderSizePixel = 0
			ColorDisplay.Parent = ColorPicker
			local _corner = Instance.new("UICorner", ColorDisplay); _corner.CornerRadius = UDim.new(0, 4)

			local ColorButton = Instance.new("TextButton")
			ColorButton.Size = UDim2.new(1, -120, 0, 24)
			ColorButton.Position = UDim2.new(0, 8, 0, 28)
			ColorButton.BackgroundColor3 = Color3.fromRGB(35,35,35)
			ColorButton.Text = ""
			ColorButton.AutoButtonColor = false
			ColorButton.Parent = ColorPicker
			local _cc = Instance.new("UICorner", ColorButton); _cc.CornerRadius = UDim.new(0,4)

			-- popup
			local Popup = Instance.new("Frame")
			Popup.Name = "ColorPickerPopup"
			Popup.Size = UDim2.new(0, 260, 0, 120)
			Popup.Position = UDim2.new(0.5, -130, 0.5, -60)
			Popup.BackgroundColor3 = library.Theme.Panel
			Popup.Visible = false
			Popup.Parent = library.ScreenGui
			local _pc = Instance.new("UICorner", Popup); _pc.CornerRadius = UDim.new(0,6)

			local Confirm = Instance.new("TextButton")
			Confirm.Size = UDim2.new(0, 80, 0, 28)
			Confirm.Position = UDim2.new(1, -90, 1, -40)
			Confirm.Text = "Confirm"
			Confirm.Parent = Popup

			local Cancel = Instance.new("TextButton")
			Cancel.Size = UDim2.new(0, 80, 0, 28)
			Cancel.Position = UDim2.new(1, -180, 1, -40)
			Cancel.Text = "Cancel"
			Cancel.Parent = Popup

			-- simple color selection: pick a random color for demo on click
			ColorButton.MouseButton1Click:Connect(function()
				local newColor = Color3.fromHSV(math.random(), 0.8, 0.9)
				ColorDisplay.BackgroundColor3 = newColor
				Popup.Visible = true
			end)

			Confirm.MouseButton1Click:Connect(function()
				Popup.Visible = false
				pcall(callback, ColorDisplay.BackgroundColor3)
			end)
			Cancel.MouseButton1Click:Connect(function()
				Popup.Visible = false
			end)

			return ColorPickerFrame
		end

		function sectionFunctions:Toggle(text, default, callback)
			default = default or false
			callback = callback or function() end

			local ToggleFrame = Instance.new("Frame")
			ToggleFrame.Name = text.."ToggleFrame"
			ToggleFrame.Size = UDim2.new(1, 0, 0, 36)
			ToggleFrame.BackgroundTransparency = 1
			ToggleFrame.Parent = TabContent

			local Toggle = Instance.new("TextButton")
			Toggle.Name = text.."Toggle"
			Toggle.Size = UDim2.new(1, 0, 1, 0)
			Toggle.BackgroundColor3 = library.Theme.Panel
			Toggle.BorderSizePixel = 0
			Toggle.Text = ""
			Toggle.AutoButtonColor = false
			Toggle.Parent = ToggleFrame

			local UICornerToggle = Instance.new("UICorner")
			UICornerToggle.CornerRadius = UDim.new(0, 6)
			UICornerToggle.Parent = Toggle

			local ToggleText = Instance.new("TextLabel")
			ToggleText.Name = "ToggleText"
			ToggleText.Size = UDim2.new(1, -56, 1, 0)
			ToggleText.Position = UDim2.new(0, 8, 0, 0)
			ToggleText.BackgroundTransparency = 1
			ToggleText.TextColor3 = library.Theme.Text
			ToggleText.TextSize = 14
			ToggleText.Font = Enum.Font.GothamMedium
			ToggleText.TextXAlignment = Enum.TextXAlignment.Left
			ToggleText.Text = text
			ToggleText.Parent = Toggle

			local ToggleBackground = Instance.new("Frame")
			ToggleBackground.Name = "ToggleBackground"
			ToggleBackground.Size = UDim2.new(0, 36, 0, 18)
			ToggleBackground.Position = UDim2.new(1, -44, 0.5, -9)
			ToggleBackground.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
			ToggleBackground.BorderSizePixel = 0
			ToggleBackground.Parent = Toggle

			local UICornerToggleBg = Instance.new("UICorner")
			UICornerToggleBg.CornerRadius = UDim.new(1, 0)
			UICornerToggleBg.Parent = ToggleBackground

			local ToggleIndicator = Instance.new("Frame")
			ToggleIndicator.Name = "ToggleIndicator"
			ToggleIndicator.Size = UDim2.new(0, 14, 0, 14)
			ToggleIndicator.Position = UDim2.new(0, 2, 0.5, -7)
			ToggleIndicator.BackgroundColor3 = Color3.fromRGB(200, 200, 200)
			ToggleIndicator.BorderSizePixel = 0
			ToggleIndicator.Parent = ToggleBackground

			local UICornerIndicator = Instance.new("UICorner")
			UICornerIndicator.CornerRadius = UDim.new(1, 0)
			UICornerIndicator.Parent = ToggleIndicator

			local toggled = default

			local function updateToggle()
				if toggled then
					TweenService:Create(ToggleBackground, TweenInfo.new(0.28), {BackgroundColor3 = library.Theme.Highlight}):Play()
					TweenService:Create(ToggleIndicator, TweenInfo.new(0.28), {Position = UDim2.new(1, -16, 0.5, -7), BackgroundColor3 = Color3.fromRGB(255,255,255)}):Play()
				else
					TweenService:Create(ToggleBackground, TweenInfo.new(0.28), {BackgroundColor3 = Color3.fromRGB(60, 60, 60)}):Play()
					TweenService:Create(ToggleIndicator, TweenInfo.new(0.28), {Position = UDim2.new(0, 2, 0.5, -7), BackgroundColor3 = Color3.fromRGB(200,200,200)}):Play()
				end
				pcall(callback, toggled)
			end

			updateToggle()

			Toggle.MouseButton1Click:Connect(function()
				toggled = not toggled
				updateToggle()
			end)

			return ToggleFrame
		end

		function sectionFunctions:Notification(title, message, duration, type)
			-- reuse simplified notification from previous iteration
			title = title or "Notification"
			message = message or ""
			duration = duration or 3
			type = type or "Info"

			if not _G.ModernUINotifications then
				_G.ModernUINotifications = {}
				_G.ModernUINotifications.Container = Instance.new("Frame")
				_G.ModernUINotifications.Container.Name = "ModernUINotifications"
				_G.ModernUINotifications.Container.Size = UDim2.new(0, 320, 1, 0)
				_G.ModernUINotifications.Container.Position = UDim2.new(1, -340, 0, 20)
				_G.ModernUINotifications.Container.BackgroundTransparency = 1
				_G.ModernUINotifications.Container.Parent = library.ScreenGui

				local list = Instance.new("UIListLayout")
				list.Padding = UDim.new(0, 8)
				list.SortOrder = Enum.SortOrder.LayoutOrder
				list.VerticalAlignment = Enum.VerticalAlignment.Top
				list.Parent = _G.ModernUINotifications.Container
			end

			local notif = Instance.new("Frame")
			notif.Size = UDim2.new(0, 320, 0, 72)
			notif.BackgroundColor3 = library.Theme.Panel
			notif.Parent = _G.ModernUINotifications.Container
			local corner = Instance.new("UICorner", notif); corner.CornerRadius = UDim.new(0,6)

			local titleLabel = Instance.new("TextLabel")
			titleLabel.Size = UDim2.new(1, -20, 0, 22)
			titleLabel.Position = UDim2.new(0, 12, 0, 8)
			titleLabel.BackgroundTransparency = 1
			titleLabel.Text = title
			titleLabel.TextColor3 = library.Theme.Text
			titleLabel.Font = Enum.Font.GothamBold
			titleLabel.TextSize = 14
			titleLabel.Parent = notif

			local msgLabel = Instance.new("TextLabel")
			msgLabel.Size = UDim2.new(1, -20, 0, 36)
			msgLabel.Position = UDim2.new(0, 12, 0, 30)
			msgLabel.BackgroundTransparency = 1
			msgLabel.Text = message
			msgLabel.TextColor3 = library.Theme.SubText
			msgLabel.Font = Enum.Font.Gotham
			msgLabel.TextSize = 13
			msgLabel.TextWrapped = true
			msgLabel.Parent = notif

			task.spawn(function()
				wait(duration)
				if notif and notif.Parent then
					notif:Destroy()
				end
			end)

			return {
				Close = function() if notif and notif.Parent then notif:Destroy() end end
			}
		end

		function sectionFunctions:Slider(text, min, max, default, callback)
			min = min or 0
			max = max or 100
			default = default or min
			callback = callback or function() end

			local SliderFrame = Instance.new("Frame")
			SliderFrame.Name = text.."SliderFrame"
			SliderFrame.Size = UDim2.new(1, 0, 0, 56)
			SliderFrame.BackgroundTransparency = 1
			SliderFrame.Parent = TabContent

			local Slider = Instance.new("Frame")
			Slider.Name = text.."Slider"
			Slider.Size = UDim2.new(1, 0, 1, 0)
			Slider.BackgroundColor3 = library.Theme.Panel
			Slider.BorderSizePixel = 0
			Slider.Parent = SliderFrame

			local UICornerSlider = Instance.new("UICorner", Slider)
			UICornerSlider.CornerRadius = UDim.new(0, 6)

			local SliderText = Instance.new("TextLabel")
			SliderText.Name = "SliderText"
			SliderText.Size = UDim2.new(1, -8, 0, 20)
			SliderText.Position = UDim2.new(0, 8, 0, 6)
			SliderText.BackgroundTransparency = 1
			SliderText.TextColor3 = library.Theme.Text
			SliderText.TextSize = 14
			SliderText.Font = Enum.Font.GothamMedium
			SliderText.TextXAlignment = Enum.TextXAlignment.Left
			SliderText.Text = text
			SliderText.Parent = Slider

			local ValueText = Instance.new("TextLabel")
			ValueText.Name = "ValueText"
			ValueText.Size = UDim2.new(0, 40, 0, 20)
			ValueText.Position = UDim2.new(1, -48, 0, 6)
			ValueText.BackgroundTransparency = 1
			ValueText.TextColor3 = library.Theme.SubText
			ValueText.TextSize = 14
			ValueText.Font = Enum.Font.GothamMedium
			ValueText.TextXAlignment = Enum.TextXAlignment.Right
			ValueText.Text = tostring(default)
			ValueText.Parent = Slider

			local SliderBackground = Instance.new("Frame")
			SliderBackground.Name = "SliderBackground"
			SliderBackground.Size = UDim2.new(1, -16, 0, 6)
			SliderBackground.Position = UDim2.new(0, 8, 0, 32)
			SliderBackground.BackgroundColor3 = Color3.fromRGB(60, 60, 60)
			SliderBackground.BorderSizePixel = 0
			SliderBackground.Parent = Slider

			local UICornerSliderBg = Instance.new("UICorner", SliderBackground)
			UICornerSliderBg.CornerRadius = UDim.new(1, 0)

			local SliderFill = Instance.new("Frame")
			SliderFill.Name = "SliderFill"
			SliderFill.Size = UDim2.new((default - min) / (max - min), 0, 1, 0)
			SliderFill.BackgroundColor3 = library.Theme.Highlight
			SliderFill.BorderSizePixel = 0
			SliderFill.Parent = SliderBackground
			local _cfill = Instance.new("UICorner", SliderFill); _cfill.CornerRadius = UDim.new(1,0)

			local SliderIndicator = Instance.new("Frame")
			SliderIndicator.Name = "SliderIndicator"
			SliderIndicator.Size = UDim2.new(0, 16, 0, 16)
			SliderIndicator.Position = UDim2.new((default - min) / (max - min), 0, 0.5, -8)
			SliderIndicator.BackgroundColor3 = Color3.fromRGB(255, 255, 255)
			SliderIndicator.BorderSizePixel = 0
			SliderIndicator.AnchorPoint = Vector2.new(0.5, 0)
			SliderIndicator.Parent = SliderBackground
			local _cind = Instance.new("UICorner", SliderIndicator); _cind.CornerRadius = UDim.new(1,0)

			local value = default
			local dragging = false

			local function updateSlider()
				value = math.clamp(value, min, max)
				local percent = (value - min) / (max - min)

				SliderFill.Size = UDim2.new(percent, 0, 1, 0)
				SliderIndicator.Position = UDim2.new(percent, 0, 0.5, -8)
				ValueText.Text = tostring(math.floor(value))

				pcall(callback, value)
			end

			updateSlider()

			local function handleInputPosition(input)
				local inputPosition = input.Position
				if inputPosition then
					local percent = math.clamp((inputPosition.X - SliderBackground.AbsolutePosition.X) / SliderBackground.AbsoluteSize.X, 0, 1)
					value = min + (max - min) * percent
					updateSlider()
				end
			end

			SliderBackground.InputBegan:Connect(function(input)
				if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
					dragging = true
					handleInputPosition(input)
				end
			end)

			SliderBackground.InputEnded:Connect(function(input)
				if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
					dragging = false
				end
			end)

			UserInputService.InputChanged:Connect(function(input)
				if dragging and (input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch) then
					handleInputPosition(input)
				end
			end)

			local methods = {}
			function methods:Set(val)
				value = val
				updateSlider()
			end
			function methods:Get()
				return value
			end

			return SliderFrame, methods
		end

		return sectionFunctions
	end

	-- expose Tab as method
	library.Tab = function(self, name, icon) return UILibrary.Tab(self, name, icon) end

	-- select tab
	function library:SelectTab(name)
		for _, tab in pairs(self.Tabs) do
			if tab.Button.Name == name.."Tab" then
				tab.Content.Visible = true
				TweenService:Create(tab.Button, TweenInfo.new(0.18), {BackgroundColor3 = library.Theme.Panel:Lerp(Color3.fromRGB(60,60,60),0.12)}):Play()
				pcall(function() tab.Button.TabText.TextColor3 = library.Theme.Text end)
				TweenService:Create(tab.Indicator, TweenInfo.new(0.18), {BackgroundTransparency = 0}):Play()
				self.ActiveTab = tab
			else
				tab.Content.Visible = false
				TweenService:Create(tab.Button, TweenInfo.new(0.18), {BackgroundColor3 = library.Theme.Panel}):Play()
				pcall(function() tab.Button.TabText.TextColor3 = library.Theme.SubText end)
				TweenService:Create(tab.Indicator, TweenInfo.new(0.18), {BackgroundTransparency = 1}):Play()
			end
		end
	end

	return library
end

-- allow module-style calling: ModernUI.new(...)
setmetatable(UILibrary, { __call = function(_, ...) return UILibrary.new(...) end })

return UILibrary
